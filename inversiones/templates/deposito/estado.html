{% extends 'base.html' %}

{% block content %}
  <h2>Crear Dep√≥sito</h2>

  <form method="POST">
    {% csrf_token %}
    <label for="monto">Monto en USD:</label>
    <input type="number" id="monto" name="monto" step="0.01" min="0" value="{{ request.POST.monto }}" required>
    <button type="submit" class="btn btn-primary">Generar enlace de pago</button>
  </form>

  {% if deposito %}
    <h3>Enlace de pago:</h3>
    <p>Haz el pago usando el siguiente enlace:</p>
    <input type="text" value="{{ deposito.invoice_url }}" id="invoiceUrl" readonly>
    <button onclick="copyToClipboard()">Copiar enlace</button>
    <br>
    <a href="{{ deposito.invoice_url }}" target="_blank">Ir a NOWPayments</a>
  {% endif %}

  <script>
    function copyToClipboard() {
      const copyText = document.getElementById("invoiceUrl");
      copyText.select();
      document.execCommand("copy");
      alert("Enlace copiado al portapapeles!");
    }
  </script>

{% endblock %}
